#!/bin/bash
# Run RuboCop linter for code quality checks

# Source common functions
source "$(dirname "$0")/_common"
check_docker

# Check if --fix flag is present
if [[ "$*" == *"--fix"* ]]; then
    echo "ğŸ”§ Running RuboCop with auto-fix..."
    echo "ğŸ’¡ This will automatically correct fixable style issues"
    echo "âš ï¸  Auto-fix will modify your code files"
    echo ""
else
    echo "ğŸ” Running RuboCop linter..."
    echo "ğŸ’¡ This will check code style and quality"
    echo "ğŸ”§ Use './dx/lint --fix' to automatically fix issues"
    echo ""
fi

# Run RuboCop with container
docker-compose -f docker-compose.dev.yml exec app bundle exec rubocop "$@"

echo ""
if [[ "$*" == *"--fix"* ]]; then
    echo "âœ… Auto-fix complete! Review changes before committing."
else
    echo "âœ… Linting complete!"
fi