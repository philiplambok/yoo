#!/bin/bash
# Run RuboCop linter for code quality checks

# Source common functions
source "$(dirname "$0")/_common"
check_docker

# Check if --fix flag is present
if [[ "$*" == *"--fix"* ]]; then
    echo "🔧 Running RuboCop with auto-fix..."
    echo "💡 This will automatically correct fixable style issues"
    echo "⚠️  Auto-fix will modify your code files"
    echo ""
else
    echo "🔍 Running RuboCop linter..."
    echo "💡 This will check code style and quality"
    echo "🔧 Use './dx/lint --fix' to automatically fix issues"
    echo ""
fi

# Run RuboCop with container
docker-compose -f docker-compose.dev.yml exec app bundle exec rubocop "$@"

echo ""
if [[ "$*" == *"--fix"* ]]; then
    echo "✅ Auto-fix complete! Review changes before committing."
else
    echo "✅ Linting complete!"
fi